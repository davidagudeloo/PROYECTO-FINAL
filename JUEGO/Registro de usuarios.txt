#include <iostream>
#include <string.h>
#include <fstream>

using namespace std;

int main()
{
    string nombre, clave;

    int opcion;
    cout<<"1.Registrar usuario."<<endl;
    cout<<"2.Inicio de sesion."<<endl;
    cout<<"Ingrese opcion: ";
    cin>>opcion;

    switch (opcion) {
    case 1:{
        ofstream archivoEscritura;
        archivoEscritura.open("Usuarios.txt", ios::app);

        ifstream archivoLectura;
        archivoLectura.open("Usuarios.txt", ios::in);

        cout<<"Ingrese nombre: ";
        cin>>nombre;
        cout<<"Ingrese clave: ";
        cin>>clave;

        string nombre_, linea;

        while(!archivoLectura.eof() && !archivoEscritura.eof()){
            getline(archivoLectura,linea);
            for(int i=0; linea[i]!=' '; i++){ //Tomo letra por letra la linea leida
                nombre_=nombre_+linea[i];
            }
            if(nombre_==nombre){
                cout<<"EL NOMBRE DE USUARIO YA EXISTE"<<endl;
                cout<<endl;
                cout<<"Ingrese nombre: ";
                cin>>nombre;
                cout<<"Ingrese clave: ";
                cin>>clave;
                archivoLectura.clear();
                archivoLectura.seekg(0, archivoLectura.beg);
            }
            nombre_="";
        }
        archivoEscritura<<nombre<<" "<<clave<<"\n"<<"1"<<"\n"<<"2"<<"\n"<<"3"<<"\n";
        archivoEscritura.close();
        archivoLectura.close();
    }
        break;

    case 2:{

        string nombre, clave;

        ifstream archivoLectura;
        archivoLectura.open("Usuarios.txt", ios::in);

        cout<<"Ingrese nombre: ";
        cin>>nombre;
        cout<<"Ingrese clave: ";
        cin>>clave;
        cout<<endl;

        string nombre_clave=nombre+' '+clave, linea, datos[3];
        //int verif=3;


        while(!archivoLectura.eof()||nombre_clave.length()>0){
            getline(archivoLectura,linea);
            for(int i=0; i<3; i++){
                getline(archivoLectura,datos[i]);
            }
            if(nombre_clave==linea){
                cout<<"USUARIO ENCONTRADO"<<endl;
                cout<<nombre<<endl;
                for(int i=0; i<3; i++){
                    cout<<datos[i]<<endl;
                }
                archivoLectura.close();
                break;
            }
            while(nombre_clave!=linea && archivoLectura.eof()){
                cout<<"USUARIO O CLAVE INCORRECTA"<<endl;
                cout<<endl;
                nombre_clave="";
                cout<<"Ingrese nombre: ";
                cin>>nombre;
                cout<<"Ingrese clave: ";
                cin>>clave;
                archivoLectura.clear();
                archivoLectura.seekg(0, archivoLectura.beg);
                nombre_clave=nombre+' '+clave;
            }
        }
        archivoLectura.close();

    } //case 2
        break;

    } //switch

    return 0;
}